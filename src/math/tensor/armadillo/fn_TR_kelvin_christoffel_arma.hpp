//
// Created by Christian Messe on 22.12.20.
//

#ifndef BELFEM_FN_TR_KELVIN_CHRISTOFFEL_ARMA_HPP
#define BELFEM_FN_TR_KELVIN_CHRISTOFFEL_ARMA_HPP

namespace belfem
{
    namespace tensor
    {
//----------------------------------------------------------------------------

	  /**
		*     C_ik = A_ijkl * B_j * B_l
		*/
        template < typename T >
        inline void
        kelvin_christoffel( const T * A, const T * B, T * C )
        {
            C[ 0 ] =    B[ 0 ] * (  B[ 0 ] * A[  0 ] + B[ 1 ] * A[ 27 ] + B[ 2 ] * A[ 54 ] )
                      + B[ 1 ] * (  B[ 0 ] * A[  3 ] + B[ 1 ] * A[ 30 ] + B[ 2 ] * A[ 57 ] )
                      + B[ 2 ] * (  B[ 0 ] * A[  6 ] + B[ 1 ] * A[ 33 ] + B[ 2 ] * A[ 60 ] );
            C[ 1 ] =    B[ 0 ] * (  B[ 0 ] * A[  1 ] + B[ 1 ] * A[ 28 ] + B[ 2 ] * A[ 55 ] )
                      + B[ 1 ] * (  B[ 0 ] * A[  4 ] + B[ 1 ] * A[ 31 ] + B[ 2 ] * A[ 58 ] )
                      + B[ 2 ] * (  B[ 0 ] * A[  7 ] + B[ 1 ] * A[ 34 ] + B[ 2 ] * A[ 61 ] );
            C[ 2 ] =    B[ 0 ] * (  B[ 0 ] * A[  2 ] + B[ 1 ] * A[ 29 ] + B[ 2 ] * A[ 56 ] )
                      + B[ 1 ] * (  B[ 0 ] * A[  5 ] + B[ 1 ] * A[ 32 ] + B[ 2 ] * A[ 59 ] )
                      + B[ 2 ] * (  B[ 0 ] * A[  8 ] + B[ 1 ] * A[ 35 ] + B[ 2 ] * A[ 62 ] );
            C[ 3 ] =    B[ 0 ] * (  B[ 0 ] * A[  9 ] + B[ 1 ] * A[ 36 ] + B[ 2 ] * A[ 63 ] )
                      + B[ 1 ] * (  B[ 0 ] * A[ 12 ] + B[ 1 ] * A[ 39 ] + B[ 2 ] * A[ 66 ] )
                      + B[ 2 ] * (  B[ 0 ] * A[ 15 ] + B[ 1 ] * A[ 42 ] + B[ 2 ] * A[ 69 ] );
            C[ 4 ] =    B[ 0 ] * (  B[ 0 ] * A[ 10 ] + B[ 1 ] * A[ 37 ] + B[ 2 ] * A[ 64 ] )
                      + B[ 1 ] * (  B[ 0 ] * A[ 13 ] + B[ 1 ] * A[ 40 ] + B[ 2 ] * A[ 67 ] )
                      + B[ 2 ] * (  B[ 0 ] * A[ 16 ] + B[ 1 ] * A[ 43 ] + B[ 2 ] * A[ 70 ] );
            C[ 5 ] =    B[ 0 ] * (  B[ 0 ] * A[ 11 ] + B[ 1 ] * A[ 38 ] + B[ 2 ] * A[ 65 ] )
                      + B[ 1 ] * (  B[ 0 ] * A[ 14 ] + B[ 1 ] * A[ 41 ] + B[ 2 ] * A[ 68 ] )
                      + B[ 2 ] * (  B[ 0 ] * A[ 17 ] + B[ 1 ] * A[ 44 ] + B[ 2 ] * A[ 71 ] );
            C[ 6 ] =    B[ 0 ] * (  B[ 0 ] * A[ 18 ] + B[ 1 ] * A[ 45 ] + B[ 2 ] * A[ 72 ] )
                      + B[ 1 ] * (  B[ 0 ] * A[ 21 ] + B[ 1 ] * A[ 48 ] + B[ 2 ] * A[ 75 ] )
                      + B[ 2 ] * (  B[ 0 ] * A[ 24 ] + B[ 1 ] * A[ 51 ] + B[ 2 ] * A[ 78 ] );
            C[ 7 ] =    B[ 0 ] * (  B[ 0 ] * A[ 19 ] + B[ 1 ] * A[ 46 ] + B[ 2 ] * A[ 73 ] )
                      + B[ 1 ] * (  B[ 0 ] * A[ 22 ] + B[ 1 ] * A[ 49 ] + B[ 2 ] * A[ 76 ] )
                      + B[ 2 ] * (  B[ 0 ] * A[ 25 ] + B[ 1 ] * A[ 52 ] + B[ 2 ] * A[ 79 ] );
            C[ 8 ] =    B[ 0 ] * (  B[ 0 ] * A[ 20 ] + B[ 1 ] * A[ 47 ] + B[ 2 ] * A[ 74 ] )
                      + B[ 1 ] * (  B[ 0 ] * A[ 23 ] + B[ 1 ] * A[ 50 ] + B[ 2 ] * A[ 77 ] )
                      + B[ 2 ] * (  B[ 0 ] * A[ 26 ] + B[ 1 ] * A[ 53 ] + B[ 2 ] * A[ 80 ] );
        }

//----------------------------------------------------------------------------
    }
}
#endif //BELFEM_FN_TR_KELVIN_CHRISTOFFEL_HPP
