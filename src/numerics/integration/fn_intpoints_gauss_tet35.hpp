//
// Created by Christian Messe on 15.07.20.
//

#ifndef BELFEM_FN_INTPOINTS_GAUSS_TET35_HPP
#define BELFEM_FN_INTPOINTS_GAUSS_TET35_HPP

#include "typedefs.hpp"
#include "cl_Vector.hpp"
#include "cl_Matrix.hpp"
#include "fn_sum.hpp"

// ----------------------------------------------------------------------------
namespace belfem
{
    namespace integration
    {
// ----------------------------------------------------------------------------

        // 7th order
        // source Shunn and Ham, 10.1016/j.cam.2012.03.032
        inline void
        gauss_tet35(
                Vector <real> & aWeights,
                Matrix <real> & aPoints )
        {
            aPoints.set_size( 4, 35 );
            aWeights.set_size( 35 );

            aPoints( 0 , 0 ) =  0.9197896733368800 ;
            aPoints( 1 , 0 ) =  0.0267367755543735 ;
            aPoints( 2 , 0 ) =  0.0267367755543735 ;

            aPoints( 0 , 1 ) =  0.0267367755543735 ;
            aPoints( 1 , 1 ) =  0.9197896733368800 ;
            aPoints( 2 , 1 ) =  0.0267367755543735 ;

            aPoints( 0 , 2 ) =  0.0267367755543735 ;
            aPoints( 1 , 2 ) =  0.0267367755543735 ;
            aPoints( 2 , 2 ) =  0.9197896733368800 ;

            aPoints( 0 , 3 ) =  0.0267367755543735 ;
            aPoints( 1 , 3 ) =  0.0267367755543735 ;
            aPoints( 2 , 3 ) =  0.0267367755543735 ;

            aPoints( 0 , 4 ) =  0.1740356302468940 ;
            aPoints( 1 , 4 ) =  0.7477598884818090 ;
            aPoints( 2 , 4 ) =  0.0391022406356488 ;

            aPoints( 0 , 5 ) =  0.7477598884818090 ;
            aPoints( 1 , 5 ) =  0.1740356302468940 ;
            aPoints( 2 , 5 ) =  0.0391022406356488 ;

            aPoints( 0 , 6 ) =  0.1740356302468940 ;
            aPoints( 1 , 6 ) =  0.0391022406356488 ;
            aPoints( 2 , 6 ) =  0.7477598884818090 ;

            aPoints( 0 , 7 ) =  0.7477598884818090 ;
            aPoints( 1 , 7 ) =  0.0391022406356488 ;
            aPoints( 2 , 7 ) =  0.1740356302468940 ;

            aPoints( 0 , 8 ) =  0.1740356302468940 ;
            aPoints( 1 , 8 ) =  0.0391022406356488 ;
            aPoints( 2 , 8 ) =  0.0391022406356488 ;

            aPoints( 0 , 9 ) =  0.7477598884818090 ;
            aPoints( 1 , 9 ) =  0.0391022406356488 ;
            aPoints( 2 , 9 ) =  0.0391022406356488 ;

            aPoints( 0 , 10 ) =  0.0391022406356488 ;
            aPoints( 1 , 10 ) =  0.1740356302468940 ;
            aPoints( 2 , 10 ) =  0.7477598884818090 ;

            aPoints( 0 , 11 ) =  0.0391022406356488 ;
            aPoints( 1 , 11 ) =  0.7477598884818090 ;
            aPoints( 2 , 11 ) =  0.1740356302468940 ;

            aPoints( 0 , 12 ) =  0.0391022406356488 ;
            aPoints( 1 , 12 ) =  0.1740356302468940 ;
            aPoints( 2 , 12 ) =  0.0391022406356488 ;

            aPoints( 0 , 13 ) =  0.0391022406356488 ;
            aPoints( 1 , 13 ) =  0.7477598884818090 ;
            aPoints( 2 , 13 ) =  0.0391022406356488 ;

            aPoints( 0 , 14 ) =  0.0391022406356488 ;
            aPoints( 1 , 14 ) =  0.0391022406356488 ;
            aPoints( 2 , 14 ) =  0.1740356302468940 ;

            aPoints( 0 , 15 ) =  0.0391022406356488 ;
            aPoints( 1 , 15 ) =  0.0391022406356488 ;
            aPoints( 2 , 15 ) =  0.7477598884818090 ;

            aPoints( 0 , 16 ) =  0.4547545999844830 ;
            aPoints( 1 , 16 ) =  0.4547545999844830 ;
            aPoints( 2 , 16 ) =  0.0452454000155172 ;

            aPoints( 0 , 17 ) =  0.4547545999844830 ;
            aPoints( 1 , 17 ) =  0.0452454000155172 ;
            aPoints( 2 , 17 ) =  0.4547545999844830 ;

            aPoints( 0 , 18 ) =  0.4547545999844830 ;
            aPoints( 1 , 18 ) =  0.0452454000155172 ;
            aPoints( 2 , 18 ) =  0.0452454000155172 ;

            aPoints( 0 , 19 ) =  0.0452454000155172 ;
            aPoints( 1 , 19 ) =  0.4547545999844830 ;
            aPoints( 2 , 19 ) =  0.4547545999844830 ;

            aPoints( 0 , 20 ) =  0.0452454000155172 ;
            aPoints( 1 , 20 ) =  0.4547545999844830 ;
            aPoints( 2 , 20 ) =  0.0452454000155172 ;

            aPoints( 0 , 21 ) =  0.0452454000155172 ;
            aPoints( 1 , 21 ) =  0.0452454000155172 ;
            aPoints( 2 , 21 ) =  0.4547545999844830 ;

            aPoints( 0 , 22 ) =  0.5031186450145980 ;
            aPoints( 1 , 22 ) =  0.2232010379623150 ;
            aPoints( 2 , 22 ) =  0.2232010379623150 ;

            aPoints( 0 , 23 ) =  0.2232010379623150 ;
            aPoints( 1 , 23 ) =  0.5031186450145980 ;
            aPoints( 2 , 23 ) =  0.2232010379623150 ;

            aPoints( 0 , 24 ) =  0.2232010379623150 ;
            aPoints( 1 , 24 ) =  0.2232010379623150 ;
            aPoints( 2 , 24 ) =  0.5031186450145980 ;

            aPoints( 0 , 25 ) =  0.5031186450145980 ;
            aPoints( 1 , 25 ) =  0.2232010379623150 ;
            aPoints( 2 , 25 ) =  0.0504792790607720 ;

            aPoints( 0 , 26 ) =  0.2232010379623150 ;
            aPoints( 1 , 26 ) =  0.5031186450145980 ;
            aPoints( 2 , 26 ) =  0.0504792790607720 ;

            aPoints( 0 , 27 ) =  0.2232010379623150 ;
            aPoints( 1 , 27 ) =  0.2232010379623150 ;
            aPoints( 2 , 27 ) =  0.0504792790607720 ;

            aPoints( 0 , 28 ) =  0.5031186450145980 ;
            aPoints( 1 , 28 ) =  0.0504792790607720 ;
            aPoints( 2 , 28 ) =  0.2232010379623150 ;

            aPoints( 0 , 29 ) =  0.2232010379623150 ;
            aPoints( 1 , 29 ) =  0.0504792790607720 ;
            aPoints( 2 , 29 ) =  0.5031186450145980 ;

            aPoints( 0 , 30 ) =  0.2232010379623150 ;
            aPoints( 1 , 30 ) =  0.0504792790607720 ;
            aPoints( 2 , 30 ) =  0.2232010379623150 ;

            aPoints( 0 , 31 ) =  0.0504792790607720 ;
            aPoints( 1 , 31 ) =  0.5031186450145980 ;
            aPoints( 2 , 31 ) =  0.2232010379623150 ;

            aPoints( 0 , 32 ) =  0.0504792790607720 ;
            aPoints( 1 , 32 ) =  0.2232010379623150 ;
            aPoints( 2 , 32 ) =  0.5031186450145980 ;

            aPoints( 0 , 33 ) =  0.0504792790607720 ;
            aPoints( 1 , 33 ) =  0.2232010379623150 ;
            aPoints( 2 , 33 ) =  0.2232010379623150 ;

            aPoints( 0 , 34 ) =  0.25 ;
            aPoints( 1 , 34 ) =  0.25 ;
            aPoints( 2 , 34 ) =  0.25 ;

            for( uint k=0; k<35; ++k )
            {
                aPoints( 3, k ) =  1.0
                                   - aPoints( 0, k )
                                   - aPoints( 1, k )
                                   - aPoints( 2, k );
            }

            aWeights(  0 ) =  0.000365007732756467 ;
            aWeights(  1 ) =  0.000365007732756467 ;
            aWeights(  2 ) =  0.000365007732756467 ;
            aWeights(  3 ) =  0.000365007732756467 ;

            aWeights(  4 ) =  0.00238992783629442 ;
            aWeights(  5 ) =  0.00238992783629442 ;
            aWeights(  6 ) =  0.00238992783629442 ;
            aWeights(  7 ) =  0.00238992783629442 ;
            aWeights(  8 ) =  0.00238992783629442 ;
            aWeights(  9 ) =  0.00238992783629442 ;
            aWeights( 10 ) =  0.00238992783629442 ;
            aWeights( 11 ) =  0.00238992783629442 ;
            aWeights( 12 ) =  0.00238992783629442 ;
            aWeights( 13 ) =  0.00238992783629442 ;
            aWeights( 14 ) =  0.00238992783629442 ;
            aWeights( 15 ) =  0.00238992783629442 ;

            aWeights( 16 ) =  0.00417175659477910 ;
            aWeights( 17 ) =  0.00417175659477910 ;
            aWeights( 18 ) =  0.00417175659477910 ;
            aWeights( 19 ) =  0.00417175659477910 ;
            aWeights( 20 ) =  0.00417175659477910 ;
            aWeights( 21 ) =  0.00417175659477910 ;

            aWeights( 22 ) =  0.00799732221762591 ;
            aWeights( 23 ) =  0.00799732221762591 ;
            aWeights( 24 ) =  0.00799732221762591 ;
            aWeights( 25 ) =  0.00799732221762591 ;
            aWeights( 26 ) =  0.00799732221762591 ;
            aWeights( 27 ) =  0.00799732221762591 ;
            aWeights( 28 ) =  0.00799732221762591 ;
            aWeights( 29 ) =  0.00799732221762591 ;
            aWeights( 30 ) =  0.00799732221762591 ;
            aWeights( 31 ) =  0.00799732221762591 ;
            aWeights( 32 ) =  0.00799732221762591 ;
            aWeights( 33 ) =  0.00799732221762591 ;

            aWeights( 34 ) =  0.01552909551992230 ;

            aWeights( 34 ) = 0.0;
            aWeights( 34 ) = 1./6. - sum( aWeights );
        }

// ----------------------------------------------------------------------------
    }
}
#endif //BELFEM_FN_INTPOINTS_GAUSS_TET35_HPP
